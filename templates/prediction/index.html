{# templates/prediction/index.html #}
{% extends 'base.html' %}
{% load static %}
{% load static_league %}

{% block content %}
<!-- Bootstrap 아이콘 적용 
<a href="?date={{ prev_week }}" class="btn btn-outline-secondary">
    <i class="bi bi-chevron-left"></i>
</a>
-->

<!-- Bootstrap Icons CDN 추가 (base.html에 있다면 생략) -->
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons/font/bootstrap-icons.css">


<div class="container my-4">

    <!-- 날짜 선택 UI -->
    <div class="d-flex justify-content-center align-items-center my-3">
        <a href="?date={{ prev_week }}" class="btn btn-light">
            <i class="bi bi-chevron-left"></i>
        </a>

        <span class="mx-3 fs-5 fw-bold">{{ week_range }}</span>

        <a href="?date={{ next_week }}" class="btn btn-light">
            <i class="bi bi-chevron-right"></i>
        </a>

        <input type="date" class="form-control ms-3" style="width:auto;" id="datePicker">
    </div>

    {% for date, games in schedule_by_date.items %}
    <div class="card mb-4 shadow-sm">
        <div class="card-header bg-light">
            <h5>{{ date }}</h5>
        </div>
        <div class="card-body">
            {% for game in games %}
            <div class="row mb-3 align-items-center">

                <!-- 썸네일 (어웨이/홈 로고 나란히) -->
                <div class="col-md-4">
                    <a href="{% url 'prediction:pred_detail' league game.date_str game.away game.home %}" class="text-decoration-none">
                        <div class="d-flex align-items-center justify-content-between border rounded p-2">
                        <img src="{% static 'images/teams/mlb/' %}{{ game.away }}.png" alt="{{ game.away }}" class="img-fluid" style="max-height:64px; width:auto;">
                        <span class="mx-2 fw-bold">vs</span>
                        <img src="{% static 'images/teams/mlb/' %}{{ game.home }}.png" alt="{{ game.home }}" class="img-fluid" style="max-height:64px; width:auto;">
                        </div>
                    </a>
                </div>

                <!-- 타이틀도 상세 링크 연결 -->
                <div class="col-md-8">
                    <a href="{% url 'prediction:pred_detail' league game.date_str game.away game.home %}" class="text-decoration-none text-dark">
                        <h6>
                        {{ game.away }} ({{ game.away_pct }}%) vs {{ game.home }} ({{ game.home_pct }}%)<br>
                        Game Prediction by Percentage - {{ game.month }}/{{ game.day }} <br>
                        {{ league|upper }} Regular Season
                        </h6>
                    </a>
                </div>

            </div>
            <hr>
            {% endfor %}
        </div>
    </div>
    {% empty %}
    <p>No Match Schedule</p>
    {% endfor %}
</div>

<!-- script -->
<script>
  document.getElementById('datePicker').addEventListener('change', function() {
    const selectedDate = new Date(this.value);
    const month = selectedDate.getMonth() + 1;
    const day = selectedDate.getDate();
    window.location.href = `?date=${month}/${day}`;
  });
</script>

<style>
  input[type="date"]::-webkit-datetime-edit { display: none; }
  input[type="date"] { width: 40px; padding: 5px; }
</style>
    

{% endblock %}
